$schema:  http://json-schema.org/draft-04/schema#
title:          "Provisioner Request"
description: |
  Request to update a provisioner.
type:           object
properties:
  stability:
    title:        "Stability"
    description: |
      This is the stability of the provisioner. Accepted values:
        * `experimental`
        * `stable`
        * `deprecated`
    type:         string
    enum:         ["experimental", "stable", "deprecated"]
  description:
    title:        "Description"
    description: |
      Description of the provisioner.
    type:         string
  expires:
    title:        "Provisioner Expiration"
    description: |
      Date and time after which the provisioner will be automatically
      deleted by the queue.
    type:         string
    format:       date-time
  actions:
    type:         array
    items:
      type:       object
      title:      Actions
      description: |
        Actions are defined on the provisioner. When an action is triggered,
        it will use the `url` and `context` property to construct the URL and
        perform a `POST` request. Note that the request will be signed with the
        user's Taskcluster credentials.
        If `url='https://hardware-provisioner.mozilla-releng.net/v1/power-cycle'`
        and `context=‘worker-type’` for instance, the constructed URL will be
        `'https://hardware-provisioner.mozilla-releng.net/v1/power-cycle?provisionerId=${PROVISIONER_ID}&workerType=${WORKER_TYPE}`.
        In other words, `url` handles the path name and `context` constructs the query string.
      properties:
        label:
          title:  "Label"
          description: |
            Short names for things like logging/error messages.
          type: string
        title:
          title:  "Title"
          description: |
            Appropriate title for any sort of Modal prompt.
        context:
          title:  "Context"
          description: |
            Actions have a "context" that is one of provisioner, worker-type,
            or worker, indicating which it applies to. `context` is used to construct
            the query string of the `POST` request.
            If `context='worker'`, the query string will be
            `?provisionerId=${PROVISIONER_ID}&workerType=${WORKER_TYPE}&workerGroup=${WORKER_GROUP}&workerId=${WORKER_ID}`.
            If `context='worker-type'`, the query string will be
            `?provisionerId=${PROVISIONER_ID}&workerType=${WORKER_TYPE}`.
            If `context='provisioner'`, the query string will be
            `?provisionerId=${PROVISIONER_ID}`.
          type:   string
          enum:   ["provisioner", "worker-type", "worker"]
        url:
          title:  "URL"
          description: |
            When an action is triggered, the `url`
            and `context` property are used to make the `POST` request.
            The request will be signed with the user's Taskcluster credentials.
          type:   string
          format: uri
        description:
          title:  "Description"
          description: |
            Description of the provisioner.
          type:   string
      additionalProperties: false
      required:
        - label
        - title
        - context
        - url
        - description
additionalProperties: false
